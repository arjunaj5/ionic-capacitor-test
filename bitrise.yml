format_version: '11'
default_step_lib_source: https://github.com/bitrise-io/bitrise-steplib.git

project_type: ionic

workflows:
  # Android Debug Build
  debug:
    steps:
    - activate-ssh-key@4:
        run_if: '{{getenv "SSH_RSA_PRIVATE_KEY" | length}}'
    - git-clone@6: {}
    - cache-pull@2: {}
    - install-missing-android-tools@3:
        inputs:
        - gradle_version: '8.0'
    - script@1:
        title: Install Node.js dependencies
        inputs:
        - content: |
            #!/bin/bash
            set -e
            npm ci
    - script@1:
        title: Install Ruby dependencies
        inputs:
        - content: |
            #!/bin/bash
            set -e
            gem install bundler
            bundle install
    - script@1:
        title: Build Android Debug APK
        inputs:
        - content: |
            #!/bin/bash
            set -e
            bundle exec fastlane debug
    - deploy-to-bitrise-io@2: {}

app:
  envs:
  - BITRISE_PROJECT_PATH: .
  - BITRISE_BUILD_NUMBER: $BITRISE_BUILD_NUMBER
  - BITRISE_BUILD_URL: $BITRISE_BUILD_URL
  - GOOGLE_PLAY_SERVICE_ACCOUNT_EMAIL: $GOOGLE_PLAY_SERVICE_ACCOUNT_EMAIL
  - GOOGLE_PLAY_SERVICE_ACCOUNT_JSON_KEY_PATH: $GOOGLE_PLAY_SERVICE_ACCOUNT_JSON_KEY_PATH
